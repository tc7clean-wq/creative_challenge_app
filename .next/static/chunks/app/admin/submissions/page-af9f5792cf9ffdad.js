(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8248],{63:(e,s,t)=>{"use strict";var r=t(7260);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},3044:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(5155),l=t(2115),n=t(9523),i=t(63),a=t(3702),c=t(1175);function d(){let[e,s]=(0,l.useState)([]),[t,d]=(0,l.useState)(!0),[o,u]=(0,l.useState)(null),[x,m]=(0,l.useState)("pending"),h=(0,i.useRouter)(),p=(0,l.useCallback)(async()=>{try{d(!0);let e=(0,n.U)().from("submissions").select("\n          id,\n          title,\n          description,\n          image_url,\n          votes,\n          status,\n          created_at,\n          profiles!inner(username, full_name, avatar_url)\n        ").order("created_at",{ascending:!1});"all"!==x&&(e=e.eq("status",x));let{data:t,error:r}=await e;if(r){console.error("Error fetching submissions:",r),u("Failed to fetch submissions");return}let l=(null==t?void 0:t.map(e=>({...e,profiles:Array.isArray(e.profiles)?e.profiles[0]:e.profiles})))||[];s(l)}catch(e){console.error("Error:",e),u("An unexpected error occurred")}finally{d(!1)}},[x]),g=async(e,t)=>{try{let r=(0,n.U)(),{error:l}=await r.from("submissions").update({status:t}).eq("id",e);if(l){console.error("Error updating submission:",l),u("Failed to ".concat(t," submission"));return}s(s=>s.map(s=>s.id===e?{...s,status:t}:s))}catch(e){console.error("Error:",e),u("An unexpected error occurred")}};return((0,l.useEffect)(()=>{p()},[p]),t)?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-white text-xl",children:"Loading submissions..."})}):(0,r.jsx)(c.A,{children:(0,r.jsxs)("div",{className:"min-h-screen cyber-bg p-6",children:[(0,r.jsx)(a.A,{}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white",children:"Admin - Submissions"}),(0,r.jsx)("button",{onClick:()=>h.back(),className:"bg-white/20 text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-colors",children:"← Back"})]}),o&&(0,r.jsx)("div",{className:"bg-red-500/20 border border-red-500 text-red-200 px-4 py-3 rounded-lg mb-6",children:o}),(0,r.jsx)("div",{className:"flex space-x-4 mb-6",children:["all","pending","approved","rejected"].map(s=>(0,r.jsxs)("button",{onClick:()=>m(s),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(x===s?"bg-white text-purple-900":"bg-white/20 text-white hover:bg-white/30"),children:[s.charAt(0).toUpperCase()+s.slice(1),"all"!==s&&(0,r.jsx)("span",{className:"ml-2 bg-white/20 px-2 py-1 rounded-full text-xs",children:e.filter(e=>e.status===s).length})]},s))}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{var s,t,l,n,i;return(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[(0,r.jsx)("div",{className:"aspect-square mb-4 rounded-lg overflow-hidden",children:(0,r.jsx)("img",{src:e.image_url,alt:e.title,className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white truncate",children:e.title}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"approved":return"text-green-600 bg-green-100";case"rejected":return"text-red-600 bg-red-100";case"pending":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}})(e.status)),children:e.status})]}),(0,r.jsx)("p",{className:"text-gray-300 text-sm line-clamp-2",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-sm font-bold",children:(null==(l=e.profiles)||null==(t=l.username)||null==(s=t.charAt(0))?void 0:s.toUpperCase())||"?"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium text-sm",children:(null==(n=e.profiles)?void 0:n.full_name)||(null==(i=e.profiles)?void 0:i.username)||"Unknown"}),(0,r.jsx)("p",{className:"text-gray-400 text-xs",children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-yellow-400",children:"⭐"}),(0,r.jsxs)("span",{className:"text-white font-medium",children:[e.votes," votes"]})]}),"pending"===e.status&&(0,r.jsxs)("div",{className:"flex space-x-2 pt-3",children:[(0,r.jsx)("button",{onClick:()=>g(e.id,"approved"),className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors font-medium",children:"✓ Approve"}),(0,r.jsx)("button",{onClick:()=>g(e.id,"rejected"),className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 transition-colors font-medium",children:"✗ Reject"})]}),"pending"!==e.status&&(0,r.jsx)("div",{className:"pt-3",children:(0,r.jsx)("button",{onClick:()=>g(e.id,"pending"),className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors font-medium",children:"Reset to Pending"})})]})]},e.id)})}),0===e.length&&(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-white text-xl",children:"No submissions found for the selected filter."})})]})]})})}},7739:(e,s,t)=>{Promise.resolve().then(t.bind(t,3044))}},e=>{e.O(0,[7559,2619,1996,8441,1255,7358],()=>e(e.s=7739)),_N_E=e.O()}]);